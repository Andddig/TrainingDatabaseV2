<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Edit Qualification</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/styles.css">
</head>
<body>
    <%- include('./partials/header', { user }) %>
    
    <div class="container mt-4">
        <div class="row mb-4">
            <div class="col">
                <h1>Edit Qualification</h1>
                <p>Modify qualification requirements and details.</p>
            </div>
            <div class="col-auto">
                <a href="/qualifications/manage" class="btn btn-secondary">
                    <i class="fas fa-arrow-left"></i> Back to List
                </a>
            </div>
        </div>

        <% if (locals.error) { %>
            <div class="alert alert-danger"><%= error %></div>
        <% } %>
        
        <% if (locals.success) { %>
            <div class="alert alert-success"><%= success %></div>
        <% } %>

        <div class="card">
            <div class="card-body">
                <form action="/qualifications/update/<%= qualification._id %>" method="POST">
                    <div class="form-group">
                        <label for="name">Qualification Name <span class="text-danger">*</span></label>
                        <input type="text" class="form-control" id="name" name="name" value="<%= qualification.name %>" required>
                    </div>
                    <div class="form-group">
                        <label for="description">Description</label>
                        <textarea class="form-control" id="description" name="description" rows="3"><%= qualification.description %></textarea>
                    </div>
                    <div class="form-group">
                        <label>Required Training Classes <span class="text-danger">*</span></label>
                        <div class="border p-3 rounded">
                            <% if (trainingClasses && trainingClasses.length > 0) { %>
                                <div class="row">
                                    <% trainingClasses.forEach(classItem => { %>
                                        <div class="col-md-4 mb-2">
                                            <div class="custom-control custom-checkbox">
                                                <input type="checkbox" 
                                                    class="custom-control-input" 
                                                    id="class_<%= classItem._id %>" 
                                                    name="requiredClasses" 
                                                    value="<%= classItem._id %>"
                                                    <% if (qualification.requiredClasses.some(c => c._id.toString() === classItem._id.toString())) { %>checked<% } %>>
                                                <label class="custom-control-label" for="class_<%= classItem._id %>">
                                                    <%= classItem.name %>
                                                </label>
                                            </div>
                                        </div>
                                    <% }); %>
                                </div>
                            <% } else { %>
                                <div class="alert alert-warning mb-0">
                                    No training classes are available. <a href="/training/manage-classes">Create some training classes</a> first.
                                </div>
                            <% } %>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="status">Status</label>
                        <select class="form-control" id="status" name="isActive">
                            <option value="true" <% if (qualification.isActive) { %>selected<% } %>>Active</option>
                            <option value="false" <% if (!qualification.isActive) { %>selected<% } %>>Inactive</option>
                        </select>
                    </div>
                    <div class="form-group text-right">
                        <a href="/qualifications/manage" class="btn btn-secondary mr-2">Cancel</a>
                        <button type="submit" class="btn btn-primary">Save Changes</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <%- include('./partials/footer') %>
    <script src="/js/jquery.min.js"></script>
    <script src="/js/bootstrap.bundle.min.js"></script>
    <script src="https://kit.fontawesome.com/a076d05399.js"></script>
</body>
</html> 